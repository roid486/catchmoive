<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="javajo">
  <select id="mtAll" resultType="movietheaterVo">
    select * from movietheater
  </select>
  <select id="clist" resultType="customerVo">
    select * from (select rownum rowm, a.* from (select * from customer
    <choose>
    	<when test="key==null">
    		where c_id!='master'
    	</when>
    	<when test="key!=null">
    		where c_id!='master' and c_id like '%'||#{key}||'%'
    	</when>
    </choose>) a) 
    where rowm between #{num1} and #{num2}
  </select>
  <select id="login" resultType="java.lang.String">
  	select c_id from customer where c_id=#{c_id} and c_pw=#{c_pw}
  </select>
  <insert id="signup">
  	insert into customer values(#{c_id},#{c_pw},#{c_name},#{c_age},#{c_addr},#{c_tel},#{c_email},#{c_gender},#{c_check},#{c_echeck})
  </insert>
  <select id="serchcust" resultType="java.lang.Integer">
  	select count(*) from customer where c_name=#{name} and c_email=#{email}
  </select>
  <select id="serchid" resultType="java.lang.Integer">
  	select count(*) from customer where c_id=#{id}
  </select>
  <update id="echeckupdate">
  	update customer set c_echeck=#{yes} where c_email=#{email}
  </update>
  <select id="crecode" resultType="java.lang.Integer">
  	select count(*) from customer
  	<if test="key != null">
    	where c_id like '%'||#{key}||'%'
    </if>
  </select>
  <delete id="cdelete">
  	delete customer where c_id=#{c_id}
  </delete>
  <select id="scid" resultType="java.lang.String">
  	select c_id from customer where c_name=#{name} and c_email=#{email}
  </select>
  <select id="scpw" resultType="java.lang.String">
  	select c_pw from customer where c_id=#{id} and c_name=#{name} and c_email=#{email}
  </select>
  <select id="cdetail" resultType="customerVo">
  	select * from customer where c_id=#{c_id}
  </select>
  <update id="cupdate">
  	update customer set c_pw=#{c_pw}, c_name=#{c_name}, c_age=#{c_age}, c_addr=#{c_addr}, c_tel=#{c_tel}, c_email=#{c_email}, c_gender=#{c_gender}, c_check=#{c_check}, c_echeck=#{c_echeck} where c_id=#{c_id}
  </update>
  <select id="mttotalrecode" resultType="java.lang.Integer">
  	select count(*) from movietheater
  	<if test="key != null">
    	where mt_name like '%'||#{key}||'%'
    </if>
  </select>
  <select id="mtl" resultType="movietheaterVo2">
  	select * from (select rownum rowm, a.* from (select * from movietheater
  	<if test="key != null">
  		where mt_name like '%'||#{key}||'%'
  	</if>) a) 
    where rowm between #{num1} and #{num2}
  </select>
  <select id="mtautonum" resultType="java.lang.Integer">
  	select nvl(max(mt_number),0)+1 from movietheater
  </select>
  <insert id="insertmt">
  	insert into movietheater values(#{mt_number},#{mt_name},#{mt_loc},#{mt_img},#{mt_x},#{mt_y})
  </insert>
  <select id="mtdetail" resultType="movietheaterVo2">
  	select * from movietheater where mt_number=#{mt_number}
  </select>
  <update id="mtupdate">
  	update movietheater set mt_name=#{mt_name}, mt_loc=#{mt_loc}, mt_img=#{mt_img}, mt_x=#{mt_x}, mt_y=#{mt_y} where mt_number=#{mt_number}
  </update>
  <delete id="mtdelete">
  	delete movietheater where mt_number=#{mt_number}
  </delete>
  <select id="mtotalrecode" resultType="java.lang.Integer">
  	select count(*) from movie
  	<if test="key != null">
    	where m_name like '%'||#{key}||'%'
    </if>
  </select>
  <select id="mlist" resultType="movieVo_j">
  	select * from (select rownum rowm, a.* from (select * from movie
  	<if test="key != null">
  		where m_name like '%'||#{key}||'%'
  	</if>) a) 
    where rowm between #{num1} and #{num2}
  </select>
  <select id="ttotal" resultType="java.lang.Integer">
  	select count(*) from theater
  	<if test="key != null">
    	where m_name like '%'||#{key}||'%'
    </if>
  </select>
  <select id="tlist" resultType="theaterVo">
  	select * from (select rownum rowm, a.* from (select * from theater
  	<if test="key != null">
  		where t_name like '%'||#{key}||'%'
  	</if>) a) 
    where rowm between #{num1} and #{num2}
  </select>
  <insert id="tinsert">
  	insert into theater values(#{t_number},#{t_name},#{t_seat},#{mt_number})
  </insert>
  <select id="mlist2" resultType="movietheaterVo2">
  	select * from movietheater
  </select>
</mapper>